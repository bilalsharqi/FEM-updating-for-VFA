"""
Quick and dirty script to produce uCRM SOL200 design bulk data cards (requires Python > 3.6 due to f-strings).
"""

design_ids = range(1, 288)
beam_node_ids = range(1, 57)

dv_init = [0.0131,
 0.0118,
 0.00946,
 0.00785,
 0.0111,
 0.00726,
 0.00765,
 0.00853,
 0.00816,
 0.00752,
 0.00711,
 0.00677,
 0.00603,
 0.00571,
 0.00615,
 0.00728,
 0.0066,
 0.00632,
 0.00894,
 0.00615,
 0.00594,
 0.00583,
 0.00581,
 0.00584,
 0.00593,
 0.00603,
 0.00608,
 0.00613,
 0.0061,
 0.00603,
 0.00593,
 0.00588,
 0.00571,
 0.00589,
 0.00728,
 0.0111,
 0.00926,
 0.0109,
 0.0121,
 0.0111,
 0.00728,
 0.00546,
 0.00528,
 0.00528,
 0.00528,
 0.00528,
 0.00528,
 0.00528,
 0.00528,
 0.00528,
 0.00528,
 0.00528,
 0.00528,
 0.00528,
 0.00528,
 0.00528,
 0.00703,
 0.00637,
 0.00662,
 0.00943,
 0.0133,
 0.0146,
 0.0108,
 0.00711,
 0.00728,
 0.00528,
 0.00528,
 0.00542,
 0.00579,
 0.00616,
 0.00698,
 0.00847,
 0.0123,
 0.0118,
 0.00793,
 0.00725,
 0.00584,
 0.00728,
 0.00652,
 0.00633,
 0.00929,
 0.00728,
 0.0111,
 0.00728,
 0.00879,
 0.00607,
 0.00728,
 0.00584,
 0.00575,
 0.00562,
 0.00565,
 0.00569,
 0.00749,
 0.0056,
 0.00552,
 0.00728,
 0.00538,
 0.0053,
 0.00528,
 0.00528,
 0.00528,
 0.00528,
 0.00528,
 0.00528,
 0.00528,
 0.00528,
 0.00528,
 0.00528,
 0.00528,
 0.00528,
 0.0057,
 0.00502,
 0.00572,
 0.00607,
 0.00487,
 0.00487,
 0.00487,
 0.00496,
 0.00511,
 0.00513,
 0.00511,
 0.00516,
 0.00509,
 0.00492,
 0.00487,
 0.00487,
 0.00664,
 0.00531,
 0.00507,
 0.00493,
 0.00487,
 0.00487,
 0.00487,
 0.00487,
 0.00487,
 0.00487,
 0.00487,
 0.00487,
 0.00487,
 0.00487,
 0.00487,
 0.00487,
 0.00487,
 0.00487,
 0.00487,
 0.00487,
 0.00487,
 0.00487,
 0.00487,
 0.00487,
 0.00487,
 0.00487,
 0.00487,
 0.00487,
 0.00487,
 0.00487,
 0.00487,
 0.00487,
 0.00487,
 0.00487,
 0.00487,
 0.00487,
 0.00487,
 0.00487,
 0.00487,
 0.00487,
 0.00487,
 0.0046,
 0.00466,
 0.00466,
 0.00464,
 0.00518,
 0.00463,
 0.00569,
 0.00461,
 0.0062,
 0.00498,
 0.00675,
 0.00546,
 0.00745,
 0.00594,
 0.00813,
 0.00643,
 0.00876,
 0.00717,
 0.00938,
 0.00795,
 0.00998,
 0.00873,
 0.0106,
 0.00949,
 0.0112,
 0.0103,
 0.0119,
 0.011,
 0.0127,
 0.0118,
 0.0136,
 0.0125,
 0.0145,
 0.0132,
 0.0154,
 0.014,
 0.0163,
 0.0149,
 0.0172,
 0.0157,
 0.0181,
 0.0165,
 0.0189,
 0.0174,
 0.0198,
 0.0182,
 0.0206,
 0.0191,
 0.0215,
 0.02,
 0.0223,
 0.0209,
 0.0232,
 0.0217,
 0.0241,
 0.0226,
 0.025,
 0.0235,
 0.0259,
 0.0244,
 0.0264,
 0.0252,
 0.0271,
 0.0259,
 0.028,
 0.0268,
 0.0288,
 0.0275,
 0.0286,
 0.0274,
 0.0285, 0.028, 0.0256, 0.035, 0.0262, 0.0352, 0.0261, 0.0342, 0.0255, 0.0333,
 0.0247, 0.0322, 0.0239, 0.0311, 0.0231, 0.03, 0.0223, 0.0289, 0.0215, 0.0278,
 0.0207, 0.0267, 0.0199, 0.0256, 0.0191, 0.0245, 0.0184, 0.0245, 0.0177, 0.0234,
 0.0179, 0.0223, 0.0171, 0.0213, 0.0173, 0.0268, 0.0185, 0.0257, 0.0178, 0.0246,
 0.017, 0.0235, 0.0164, 0.0339, 0.0115, 0.00487, 0.0164, 0.045, 0.0141, 0.0142]
dv_lb = 0.001
dv_ub = 1.0

with open("../uCRM-135_design_data.bdf", "w") as input_file:

    input_file.write('$...Design Variables\n')
    input_file.write('$DESVAR, ID, LABEL, XINIT, XLB, XUB, DELXV,\n')
    for (des_id, init_val) in zip(design_ids, dv_init):
        card = f'DESVAR,{des_id:8d},T_{des_id:d},{init_val:.2e},{dv_lb:.2e},{dv_ub:.2e},\n'
        print(card)
        input_file.write(card)

    input_file.write('$...Link Designable Properties to Design Variables\n')
    input_file.write('$DVPREL1, ID, TYPE, PID, PNAME, PMIN, PMAX, C0,, ,\n')
    input_file.write('$       , DVID1, COEF1,\n')
    for des_id in design_ids:
        card1 = f'DVPREL1,{des_id:8d},PSHELL,{des_id:8d}, T,\n'
        card2 = f'       ,{des_id:8d}, 1.0,\n'
        print(card1)
        print(card2)
        input_file.write(card1)
        input_file.write(card2)

    input_file.write('$...Design Responses\n')
    input_file.write('$ Weight Response\n')
    input_file.write('$DRESP1,     ID, LABEL,  RTYPE,\n')
    input_file.write('DRESP1, 9999999,    WT, WEIGHT,\n')
    input_file.write('$ Nodal Displacemnt Responses\n')
    input_file.write('$DRESP1,  ID, LABEL, DISP, , ,   DOFS, , GID\n')
    for node_id in beam_node_ids:
        card = f'DRESP1,{node_id:8d},D{node_id:d}, DISP, , , 123456, ,{(node_id+30000000):8d}\n'
        input_file.write(card)

    input_file.write('$...DEFINE THE STATIC DESIGN CONSTRAINTS\n')
    input_file.write('DSCREEN ,DISP ,-99999.9,99999999,\n')
    input_file.write('$DCONSTR, DCID, RID, LALLOW, UALLOW,\n')
    for node_id in beam_node_ids:
        card = f'DCONSTR, 100,{node_id:8d},    , 1.0,\n'
        input_file.write(card)
